CREATE VIEW FAXPEC.V_COMUNICAZIONI_COMPLETE (
   ID_COM, 
   REF_ID_SOTTOTITOLO, 
   FLG_NOTIFICA, 
   MAIL_NOTIFICA, 
   UTE_INS, 
   COD_APP_INS, 
   ORIG_UID, 
   AZ_PROT, 
   IN_OUT, 
   APP_CODE, 
   TITOLO, 
   NOTE_TIT, 
   SOTTOTITOLO, 
   COM_CODE, 
   NOTE_SOT, 
   STATO_COMUNICAZIONE_OLD, 
   STATO_COMUNICAZIONE_NEW, 
   DATA_OPERAZIONE, 
   UTE_OPE, 
   CANALE, 
   ID_ENT_USED, 
   MAIL, 
   FAX, 
   TELEFONO, 
   CONTACT_REF, 
   REFERRAL_TYPE, 
   COGNOME, 
   NOME, 
   COD_FIS, 
   P_IVA, 
   RAGIONE_SOCIALE, 
   UFFICIO, 
   NOTE_RUB, 
   INDIRIZZO, 
   CIVICO, 
   CAP, 
   COMUNE, 
   SIGLA_PROV, 
   COD_ISO_STATO, 
   ID_REFERRAL, 
   ID_MAIL, 
   MAIL_SENDER, 
   MAIL_SUBJECT, 
   MAIL_TEXT, 
   FLG_ANNULLAMENTO, 
   FLG_CUSTOM_REFS, 
   FOLLOWS, 
   ALLEGATO_TPU, 
   ALLEGATO_EXT, 
   FLG_INS_PROT, 
   FLG_PROT_TO_UPL, 
   ALLEGATO_NAME)
AS 
   /*Generated by SQL Server Migration Assistant for Oracle version 7.3.0.*/
   SELECT 
      c0.ID_COM, 
      c0.REF_ID_SOTTOTITOLO, 
      c0.FLG_NOTIFICA, 
      c0.MAIL_NOTIFICA, 
      c0.UTE_INS, 
      c0.COD_APP_INS, 
      c0.ORIG_UID, 
      c0.AZ_PROT, 
      c0.IN_OUT, 
      c1.APP_CODE, 
      c1.TITOLO, 
      c1.note_tit, 
      c1.SOTTOTITOLO, 
      c1.COM_CODE, 
      c1.note_sot, 
      cf0.STATO_COMUNICAZIONE_OLD, 
      cf0.STATO_COMUNICAZIONE_NEW, 
      cf0.DATA_OPERAZIONE, 
      cf0.UTE_OPE, 
      cf0.CANALE, 
      re.ID_ENT_USED, 
      re.MAIL, 
      re.FAX, 
      re.TELEFONO, 
      re.CONTACT_REF, 
      re.REFERRAL_TYPE, 
      re.COGNOME, 
      re.NOME, 
      re.COD_FIS, 
      re.P_IVA, 
      re.RAGIONE_SOCIALE, 
      re.UFFICIO, 
      re.NOTE AS note_rub, 
      re.INDIRIZZO, 
      re.CIVICO, 
      re.CAP, 
      re.COMUNE, 
      re.SIGLA_PROV, 
      re.COD_ISO_STATO, 
      re.ID_REFERRAL, 
      mc.ID_MAIL, 
      mc.MAIL_SENDER, 
      mc.MAIL_SUBJECT, 
      mc.MAIL_TEXT, 
      mc.FLG_ANNULLAMENTO, 
      mc.FLG_CUSTOM_REFS, 
      mc.FOLLOWS, 
      ca.ALLEGATO_TPU, 
      ca.ALLEGATO_EXT, 
      ca.FLG_INS_PROT, 
      ca.FLG_PROT_TO_UPL, 
      ca.ALLEGATO_NAME
   FROM 
      FAXPEC.COMUNICAZIONI  AS c0 
         INNER JOIN 
         (
            SELECT 
               cs0.ID_SOTTOTITOLO, 
               cs0.SOTTOTITOLO, 
               cs0.NOTE AS note_sot, 
               cs0.COM_CODE, 
               ct0.APP_CODE, 
               ct0.TITOLO, 
               ct0.NOTE AS note_tit
            FROM 
               FAXPEC.COMUNICAZIONI_SOTTOTITOLI  AS cs0 
                  INNER JOIN FAXPEC.COMUNICAZIONI_TITOLI  AS ct0 
                  ON cs0.REF_ID_TITOLO = ct0.ID_TITOLO
            WHERE cs0.ACTIVE = 1 AND ct0.ACTIVE = 1
         )  AS c1 
         ON c0.REF_ID_SOTTOTITOLO = c1.ID_SOTTOTITOLO 
         INNER JOIN FAXPEC.COMUNICAZIONI_FLUSSO  AS cf0 
         ON c0.ID_COM = cf0.REF_ID_COM 
         LEFT OUTER JOIN 
         (
            SELECT 
               ceu.REF_ID_COMUNICAZIONE, 
               reu.ID_ENT_USED, 
               reu.MAIL, 
               reu.FAX, 
               reu.TELEFONO, 
               reu.CONTACT_REF, 
               reu.REFERRAL_TYPE, 
               reu.COGNOME, 
               reu.NOME, 
               reu.COD_FIS, 
               reu.P_IVA, 
               reu.RAGIONE_SOCIALE, 
               reu.UFFICIO, 
               reu.NOTE, 
               reu.INDIRIZZO, 
               reu.CIVICO, 
               reu.CAP, 
               reu.COMUNE, 
               reu.SIGLA_PROV, 
               reu.COD_ISO_STATO, 
               reu.ID_REFERRAL
            FROM 
               FAXPEC.RUBR_ENTITA_USED  AS reu 
                  INNER JOIN FAXPEC.COMUNICAZIONI_ENTITA_USED  AS ceu 
                  ON reu.ID_ENT_USED = ceu.REF_ID_ENT_USED
         )  AS re 
         ON re.REF_ID_COMUNICAZIONE = c0.ID_COM 
         LEFT OUTER JOIN FAXPEC.COMUNICAZIONI_ALLEGATI  AS ca 
         ON ca.REF_ID_COM = c0.ID_COM 
         LEFT OUTER JOIN FAXPEC.MAIL_CONTENT  AS mc 
         ON mc.REF_ID_COM = c0.ID_COM